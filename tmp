if(swapstate1.ne.0.and.(iR.ne.RSteps)) then
         do i = 1, CB%xDim!
            write(249,*) (LB%Psi(i, j), j = swapstate1, swapstate1+1)! !!Writing psi's AS IS
         enddo!
         if (CouplingFlag.eq.1) then
            call FixPhase(NumStates,HalfBandWidth,MatrixDim,CB%S,ncv,oldPsi,CB%Psi) !!"FIXING" PHASE
            call FixPhase(NumStates,HalfBandWidth,MatrixDim,LB%S,ncv,CB%Psi,LB%Psi)
            call FixPhase(NumStates,HalfBandWidth,MatrixDim,RB%S,ncv,CB%Psi,RB%Psi)
         endif
         !!!
         do i = 1, CB%xDim!
            write(250,*) (LB%Psi(i, j), j = swapstate1, swapstate1+1)! !!Writing psi's FIXED PHASE
         enddo!
         !
         call swap_psi(swapstate1,LB%Psi, xDim, ncv) !!SWAPPING PHASES
         call swap_psi(swapstate1,CB%Psi, xDim, ncv)
         call swap_psi(swapstate1,RB%Psi, xDim, ncv)
         !
         do i = 1, CB%xDim!
            write(251,*) (LB%Psi(i, j), j = swapstate1, swapstate1+1)!! !!Writing FIXED, SWAPPED Phases
         enddo!
      endif
      if(swapstate2.ne.0) then
            call FixPhase(NumStates,HalfBandWidth,MatrixDim,CB%S,ncv,oldPsi,CB%Psi) !!SECOND FIX FOR SECOND SWAP
            call FixPhase(NumStates,HalfBandWidth,MatrixDim,LB%S,ncv,CB%Psi,LB%Psi)
            !call CalcEigenErrors(info,iparam,MatrixDim,LB%H,HalfBandWidth+1,LB%S,HalfBandWidth,NumStates,LB%Psi,LB%Energies,ncv)
            call FixPhase(NumStates,HalfBandWidth,MatrixDim,RB%S,ncv,CB%Psi,RB%Psi)
         call swap_psi(swapstate2,LB%Psi, xDim, ncv) !!SECOND SWAP AFTER SECOND FIX
         call swap_psi(swapstate2,CB%Psi, xDim, ncv)
         call swap_psi(swapstate2,RB%Psi, xDim, ncv)
      endif
      if(iR .ne. RSteps) then
         call FixPhase(NumStates,HalfBandWidth,MatrixDim,CB%S,ncv,oldPsi,CB%Psi)
         if(swapstate1.ne.0) then!
            do i = 1, CB%xDim!!
               write(253,*) (CB%Psi(i, j), j = swapstate1, swapstate1+1)! !!FIXED CENTER PHASES
            enddo!
            !stop
         endif!
      endif
      oldPsi = CB%Psi
      call CalcEigenErrors(info,iparam,MatrixDim,CB%H,HalfBandWidth+1,CB%S,HalfBandWidth,NumStates,CB%Psi,CB%Energies,ncv)
      if (CouplingFlag.eq.1) then
         call FixPhase(NumStates,HalfBandWidth,MatrixDim,LB%S,ncv,CB%Psi,LB%Psi)
         call CalcEigenErrors(info,iparam,MatrixDim,LB%H,HalfBandWidth+1,LB%S,HalfBandWidth,NumStates,LB%Psi,LB%Energies,ncv)
         if(swapstate1.ne.0) then!
            do i = 1, LB%xDim!!
               write(252,*) (LB%Psi(i, j), j = swapstate1, swapstate1+1)!
            enddo!
            !stop
         endif!
         call FixPhase(NumStates,HalfBandWidth,MatrixDim,RB%S,ncv,CB%Psi,RB%Psi)
         call CalcEigenErrors(info,iparam,MatrixDim,RB%H,HalfBandWidth+1,RB%S,HalfBandWidth,NumStates,RB%Psi,RB%Energies,ncv)
      endif
